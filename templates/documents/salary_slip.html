<!-- templates/documents/salary_slip.html -->
 {% for m in months %}
<div class="offer-letter" style="font-family: 'Arial', sans-serif; max-width: 800px; margin: 0 auto; border: 1px solid #e0e0e0; box-shadow: 0 0 20px rgba(0,0,0,0.1); padding: 30px; position: relative; page-break-after: avoid; page-break-inside: avoid; background-color: white;">

    <!-- Watermark -->
    <div style="position: absolute; opacity: 0.05; font-size: 120px; transform: rotate(-20deg); top: 30%; left: 25%; z-index: 0; font-weight: bold; color: #e5e8ec;">
        <img src="{{ url_for('static', filename='images/lc_logo.png') }}" 
             alt="{{ company.name }} Watermark" 
             style="height: 400px; max-width: 500px; object-fit: contain; filter: grayscale(100%);">
    </div>

     <!-- Letterhead with decorative border -->
    <div class="letter-header mb-4" style="border-bottom: 2px solid #0d6efd; padding-bottom: 20px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; gap: 3rem; position: relative; z-index: 1;">
        <!-- Logo on the left -->
         <div style="flex: 0 0 auto;">
            <img src="{{ url_for('static', filename='images/' + company.logo) }}" 
                 alt="{{ company.name }} Logo" 
                 style="height: 90px; max-width: 450px; object-fit: contain;">
        </div> 
        
         <!-- Company info on the right  -->
         <div style="flex: 1; text-align: left;">
            <p style="color: #555; font-size: 12px; margin: 5px 0; line-height: 1.4;">
                <strong>Office:</strong> {{ company.address }}<br>
                <strong>Phone:</strong> {{ company.phone }}<br>
                <strong>Email:</strong> {{ company.email }}<br>
                <strong>Website:</strong> {{ company.website }}<br>
            </p>
        </div>
    </div>

    <!-- Employee Details -->
    <div style="margin-bottom: 20px; background-color: #f8f9fa; padding: 15px; border-radius: 5px; font-size: 13px; position: relative; z-index: 1; border: 1px solid #e0e0e0;">
        <div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
            <div style="flex: 1; min-width: 250px;"> 
                <p style="margin: 5px 0;"><strong>Employee Name:</strong> {{ data.full_name | default('', true) }}</p>
                <p style="margin: 5px 0;"><strong>Designation:</strong> {{ data.designation | default('', true) }}</p> 
                <p style="margin: 5px 0;"><strong>Bank Name:</strong> {{ data.bank_details.bank_name | default('', true) }}</p>
                <p style="margin: 5px 0;"><strong>Account No.:</strong> {{ data.bank_details.account_number | default('', true) }}</p>
            </div>
            <div style="flex: 1; min-width: 250px;">
                <!-- <p style="margin: 5px 0;"><strong>Month:</strong> {{ month }}</p> -->
                <p style="margin: 5px 0;">
                    <strong>Month:</strong> {{ m }}
                </p>


{% set auto_emp_num = (range(100000, 999999) | random) %}
<p style="margin: 5px 0;">
    {% if data.document_type != 'offer_letter' %}
        <p style="margin: 5px 0;">
            <strong>Employee ID:</strong> {{ data.employee_id }}
        </p>
    {% endif %}

        <!-- <strong>Employee ID:</strong> EMP{{ auto_emp_num }} -->

</p>
                <p style="margin: 5px 0;"><strong>CTC (Annual):</strong> ₹{{ "{:,.2f}".format(data.ctc|float) }}</p>
            </div>
        </div>
    </div>

{% set basic = ((data.ctc|float) * 0.5 / 12) | round(0) %}
{% set hra = (basic * 0.5) | round(0) %}
{% set conveyance = (data.ctc|float * 0.05 / 12) | round(0) %}
{% set medical = (data.ctc|float * 0.014 / 12) | round(0) %}
{% set telephone = (data.ctc|float * 0.02 / 12) | round(0) %}
{% set special_allowance = ((data.ctc|float /12) - (basic + hra + conveyance + medical + telephone)) | round(0) %}
{% set professional_tax = 200 %}
{% set da = 0 %}
{% set gross_salary = basic + hra + conveyance + medical + telephone + special_allowance %}
{% set total_deductions = professional_tax %}
{% set net_salary = (gross_salary - total_deductions) | round(0) %}

<table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 12px; position: relative; z-index: 1;">
    <thead>
        <tr style="background-color: #0d6efd; color: white;">
            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #0a58ca;">HEAD</th>
            <th style="padding: 10px; text-align: right; border-bottom: 2px solid #0a58ca;">EARNINGS (₹)</th>
            <th style="padding: 10px; text-align: right; border-bottom: 2px solid #0a58ca;">DEDUCTIONS (₹)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;"><strong>1. MONTHLY COMPONENTS</strong></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;"></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;"></td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;">Basic Salary</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(basic) }}</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;">House Rent Allowance (HRA)</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(hra) }}</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;"><strong>2. REIMBURSEMENTS</strong></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;"></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;"></td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;">Conveyance Allowance</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(conveyance) }}</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;">Medical Allowance</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(medical) }}</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;">Telephone/Mobile</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(telephone) }}</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;"><strong>3. SPECIAL ALLOWANCE</strong></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(special_allowance) }}</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;"><strong>4. DEDUCTIONS</strong></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;"></td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;"></td>
        </tr>
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #dee2e6;">Professional Tax</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">-</td>
            <td style="padding: 8px; text-align: right; border-bottom: 1px solid #dee2e6;">₹{{ "{:,.2f}".format(professional_tax) }}</td>
        </tr>
        <tr style="background-color: #e9ecef; font-weight: bold;">
            <td style="padding: 10px; border-top: 2px solid #0d6efd; border-bottom: 2px solid #0d6efd;">TOTAL</td>
            <td style="padding: 10px; text-align: right; border-top: 2px solid #0d6efd; border-bottom: 2px solid #0d6efd;">₹{{ "{:,.2f}".format(gross_salary) }}</td>
            <td style="padding: 10px; text-align: right; border-top: 2px solid #0d6efd; border-bottom: 2px solid #0d6efd;">₹{{ "{:,.2f}".format(total_deductions) }}</td>
        </tr>
    </tbody>
</table>

<div style="text-align: center; margin-bottom: 20px; position: relative; z-index: 1;">
    <div style="display: inline-block; background-color: #f8f9fa; padding: 15px 30px; border-radius: 5px; border: 1px solid #e0e0e0;">
        <h3 style="color: #0d6efd; margin-bottom: 5px; font-size: 16px; text-transform: uppercase;">
            Net Salary Payable per Month: ₹{{ "{:,.0f}".format(net_salary) }}
        </h3>
        <p style="font-style: italic; font-size: 13px; margin: 0; color: #555;">
            (₹{{ "{:,}".format(net_salary|int) }})
        </p>
        <p style="font-style: italic; font-size: 13px; margin: 0; color: #555;">
            {{ net_salary_words }}
        </p>
    </div>
</div>

    <!-- Print Button -->
    <div style="text-align: right; margin-bottom: 20px;" class="no-print">
        <button onclick="window.print()" style="padding: 8px 15px; background-color: #0d6efd; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">
            <i class="bi bi-printer-fill"></i> Print Salary Slip
        </button>
    </div>

<style>
@media print {
    body {
        margin: 0;
        padding: 0;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        background-color: white !important;
    }
    .offer-letter {
        border: none !important;
        box-shadow: none !important;
        padding: 15px !important;
        max-width: 100% !important;
        margin: 0 auto !important;
        page-break-after: avoid !important;
        page-break-inside: avoid !important;
    }
    .no-print {
        display: none !important;
    }
    table {
        page-break-inside: avoid !important;
    }
    .letter-header {
        page-break-after: avoid !important;
    }
    .watermark {
        opacity: 0.1 !important;
    }
}

@page {
    size: A4 portrait;
    margin-top: 40mm;
    margin-bottom: 15mm;
    margin-left: 15mm;
    margin-right: 15mm;
}
@page :first {
    margin-top: 15mm;
}
</style>
</div>

<hr style="margin:40px 0; page-break-after: always;">

{% endfor %}
