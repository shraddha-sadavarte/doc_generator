<!-- Action Bar (hidden in PDF) -->
<div class="action-bar">
    <div class="action-bar-container">
        <!-- Download Button (local only) -->
        <form action="{{ url_for('generate') }}" method="POST" class="action-form">
            <input type="hidden" name="upload_to_drive" value="false">
            <button type="submit" class="btn btn-primary">
                <span class="btn-icon">üì•</span>
                <span class="btn-text">Download</span>
            </button>
        </form>

        <!-- Download & Save to Drive -->
        <form action="{{ url_for('generate') }}" method="POST" class="action-form">
            <input type="hidden" name="upload_to_drive" value="true">
            <button type="submit" class="btn btn-success">
                <span class="btn-icon">‚òÅÔ∏è</span>
                <span class="btn-text">Download & Save to Drive</span>
            </button>
        </form>

        <!-- Print Button -->
        <button type="button" class="btn btn-secondary" onclick="window.print()">
            <span class="btn-icon">üñ®Ô∏è</span>
            <span class="btn-text">Print</span>
        </button>

        <!-- Cancel Button -->
        <a href="{{ url_for('admin_dashboard') }}" class="btn btn-danger">
            <span class="btn-icon">‚úï</span>
            <span class="btn-text">Cancel</span>
        </a>
    </div>
</div>

<style>
    /* Action bar styling ‚Äì hidden in print */
    .action-bar {
        background: white;
        border-bottom: 1px solid #e9ecef;
        padding: 15px 0;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .action-bar-container {
        max-width: 900px;
        margin: 0 auto;
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        align-items: center;
        padding: 0 20px;
    }
    .btn {
        padding: 12px 24px;
        border: none;
        border-radius: 8px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .btn-primary { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; }
    .btn-success { background: linear-gradient(135deg, #1e7e34 0%, #28a745 100%); color: white; }
    .btn-secondary { background: linear-gradient(135deg, #0d6efd 0%, #0dcaf0 100%); color: white; }
    .btn-danger { background: linear-gradient(135deg, #dc3545 0%, #e74c3c 100%); color: white; }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
    .btn-icon { font-size: 18px; }
    @media print { .action-bar { display: none !important; } }

    /* PDF page settings */
    @page {
        size: A4;
        margin: 2cm;
    }

    /* Experience letter styles ‚Äì screen version (centered) */
    .experience-letter {
        font-family: 'Arial', sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 30px;
        position: relative;
        background-color: white;
        border: 1px solid #e0e0e0;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    .letter-header {
        border-bottom: 2px solid #0d6efd;
        padding-bottom: 20px;
        margin-bottom: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 3rem;
    }
    h2 {
        text-align: center;
        color: #0d6efd;
        margin-bottom: 30px;
    }
    .content {
        text-align: justify;
        line-height: 1.8;
        font-size: 15px;
    }
    .signature-section {
        margin-top: 60px;
    }
    .footer-note {
        margin-top: 40px;
        border-top: 1px solid #e0e0e0;
        padding-top: 10px;
        font-size: 12px;
        color: #777;
        text-align: center;
    }

    /* Watermark container (text version) */
    .watermark-container {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        pointer-events: none;
        z-index: 0;
        color: #e5e8ec;
        font-size: 120px;
        font-weight: bold;
        opacity: 0.1;
        transform: rotate(-20deg);
        white-space: nowrap;
    }

    /* Print styles ‚Äì full width, no borders/shadows */
    @media print {
        .experience-letter {
            max-width: none;
            margin: 0;
            padding: 0;
            border: none;
            box-shadow: none;
        }
        .letter-header, .content, .signature-section, .footer-note {
            width: 100%;
        }
    }
</style>

<!-- Watermark placed OUTSIDE the main container ‚Äì appears on every page in PDF -->
{% include '_watermark.html' %}

<div class="experience-letter">
    <!-- Letterhead -->
    <div class="letter-header">
        <div>
            <img src="{{ request.url_root }}static/images/{{ company.logo }}"
                 alt="{{ company.name }} Logo"
                 style="height: 140px; max-width: 350px; object-fit: contain;">
        </div>
        <div style="text-align: left; font-size: 14px; color: #555;">
            <strong>Office:</strong> {{ company.address }}<br>
            <strong>Phone:</strong> {{ company.phone }}<br>
            <strong>Email:</strong> {{ company.email }}<br>
            <strong>Website:</strong> {{ company.website }}
        </div>
    </div>

    <!-- Date -->
    <div style="text-align: right; margin-bottom: 30px;">
        <strong>Date:</strong> {{ now.strftime('%d %B %Y') }}
    </div>

    <!-- Title -->
    <h2>EXPERIENCE CERTIFICATE</h2>

    <!-- Employee Info -->
    <div style="margin-bottom: 20px;">
        <p style="font-weight: bold; margin-bottom: 5px;">{{ data.full_name|title }}</p>
        <p style="margin-top: 0;">Employee ID: {{ "%04d"|format(employee.id) if employee else data.employee_id }}</p>
    </div>

    <!-- Content -->
    <div class="content">
        <p>
            This is to certify that <strong>{{ data.full_name|title }}</strong> was employed with 
            <strong>{{ company.name }}</strong> as a 
            <strong>{{ data.designation|title }}</strong>.
        </p>
        <p>
            The employee worked with us from 
            <strong>
                {% if data.joining_date %}
                    {{ data.joining_date.strftime('%d %B %Y') }}
                {% else %}
                    [Joining Date Not Available]
                {% endif %}
            </strong>
            to 
            <strong>
                {% if data.resignation_date %}
                    {{ data.resignation_date.strftime('%d %B %Y') }}
                {% else %}
                    Present
                {% endif %}
            </strong>.
        </p>
        <p>
            During the tenure of employment, {{ data.full_name.split()[0] }} demonstrated
            professionalism, dedication, and commitment towards assigned responsibilities.
            The employee efficiently handled duties related to the role and maintained
            good conduct and teamwork within the organization.
        </p>
        <p>
            We found {{ data.full_name.split()[0] }} to be sincere, hardworking,
            and a valuable contributor to the company. The services rendered
            were satisfactory during the period of employment.
        </p>
        <p>
            We wish {{ data.full_name.split()[0] }} all the very best for future
            professional endeavors.
        </p>
    </div>

    <!-- Signature -->
    <div class="signature-section">
        <div style="height: 80px; margin-bottom: 10px;">
            {% if company.signature %}
                <img src="{{ request.url_root }}static/images/signatures/{{ company.signature }}"
                     alt="Authorized Signature"
                     style="height: 100px; max-width: 200px; object-fit: contain;">
            {% endif %}
        </div>
        <p style="margin-bottom: 0;">
            <strong>{{ company.hr_name }}</strong><br>
            {{ company.hr_designation }}<br>
            <strong>{{ company.name }}</strong>
        </p>
    </div>

    <!-- Footer Note -->
    <div class="footer-note">
        *This is a system-generated document and does not require physical signature if digitally generated.
    </div>
</div>